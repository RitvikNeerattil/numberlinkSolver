sbatch -p gpu-A100 --account=agostinelli --nodes=1 --gres=gpu:2 --cpus-per-task=32 --mem=64G --time=36:00:00 -o /home/neerattr/numberlinkSolver/logs/numberlink-%j.out -e /home/neerattr/numberlinkSolver/logs/numberlink-%j.err --wrap "bash -lc 'set -euo pipefail; module load python3/anaconda/3.12; cd /home/neerattr/numberlinkSolver; source /home/neerattr/.venv/bin/activate; nvidia-smi -L; python -c \"import torch; assert torch.cuda.is_available(), \\\"CUDA not available\\\"; print(\\\"CUDA OK, device_count=\\\", torch.cuda.device_count())\"; python train_numberlink.py --domain numberlink.4x4x3_random_walk --heur resnet_fc.256H_2B_bn --max_itrs 20000 --search_itrs 400 --batch_size 128 --up_batch_size 32 --up_nnet_batch_size 1024 --step_max 10 --procs \$(nproc) --debug --curriculum --out_dir runs/numberlink_4x4_curriculum_20k_fix1'"
